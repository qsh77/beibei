# 6 系统测试

## 6.1 项目部署

本系统采用前后端分离架构，在进行功能测试之前，需要确保服务端与客户端环境均已正确配置。本项目使用黑盒测试方法，从用户视角出发，验证系统功能是否满足需求规格说明，同时对系统性能进行测试。部署及测试环境如表6.1所示。

**表6.1 部署测试环境表**

| 名称 | 参数 |
|------|------|
| 开发操作系统 | macOS Sonoma 14.x / Windows 11 |
| 测试操作系统 | macOS Sonoma 14.x |
| 处理器 | Apple M1 Pro |
| 内存 | 16GB DDR4 |
| 硬盘 | 512GB SSD |
| JDK版本 | OpenJDK 17.0.x |
| MySQL版本 | MySQL 8.0.x |
| Redis版本 | Redis 7.0.x |
| Node.js版本 | Node.js 18.x (npm 9.x) |
| 浏览器 | Chrome 120.x / Safari 17.x |
| 后端框架 | Spring Boot 3.x |
| 前端框架 | Vue 3.x + Element Plus |
| 构建工具 | Maven 3.8.x |
| API测试工具 | Postman / ApiFox |
| 性能测试工具 | Apache JMeter 5.6 |

## 6.2 测试方案

### 6.2.1 测试目标

本次测试的主要目标包括：

1. **功能正确性验证**：通过黑盒测试方法，验证系统各功能模块是否按照需求规格正确实现，包括正常流程和异常流程的处理。
2. **业务流程完整性**：验证从用户注册、服务浏览、预约下单、阿姨接单、服务完成到用户评价的完整业务闭环是否顺畅。
3. **接口稳定性测试**：验证后端API接口在各种输入条件下的响应是否符合预期，包括参数校验、异常处理等。
4. **系统性能评估**：评估系统在一定并发压力下的响应时间、吞吐量和资源占用情况。

### 6.2.2 测试方法

本项目采用以下测试方法：

1. **黑盒测试**：从用户角度出发，不关注内部实现细节，仅通过输入和输出验证功能正确性。主要采用等价类划分法和边界值分析法设计测试用例。
2. **功能测试**：针对每个功能模块设计测试用例，覆盖正常输入、异常输入和边界条件。
3. **接口测试**：使用Postman或ApiFox工具对后端REST API进行测试，验证接口的请求参数校验、响应格式和错误处理。
4. **性能测试**：使用JMeter模拟多用户并发访问场景，测试系统的响应时间和承载能力。

### 6.2.3 测试计划

测试工作分为以下阶段进行：

1. **单元功能测试**：针对各核心模块分别设计测试用例并执行测试。
2. **集成流程测试**：验证多模块间的协作和数据流转是否正确。
3. **性能压力测试**：使用JMeter进行并发测试，评估系统性能指标。
4. **回归测试**：修复缺陷后，重新执行相关测试用例，确保修复有效且未引入新问题。

## 6.3 功能测试和接口测试

### 6.3.1 服务预约功能测试

针对服务预约功能，重点测试了服务浏览、服务详情查看、预约表单提交、订单创建等核心流程，同时验证了各类异常情况的处理。详细测试用例如表6.2所示。

**表6.2 服务预约功能测试**

| 序号 | 测试场景 | 测试步骤 | 前置条件 | 预期结果 | 实际结果 |
|------|----------|----------|----------|----------|----------|
| 1 | 成功创建预约订单 | 1. 选择服务项目<br>2. 选择服务日期和时段<br>3. 选择服务地址<br>4. 点击"提交订单" | 用户已登录且有可用地址 | 订单创建成功，显示成功提示并跳转订单详情 | 正确无误 |
| 2 | 未登录时预约 | 1. 未登录状态下访问服务详情<br>2. 点击"立即预约" | 用户未登录 | 跳转至登录页面，提示用户先登录 | 正确无误 |
| 3 | 未选择地址提交订单 | 1. 选择服务项目和时间<br>2. 不选择地址直接提交 | 用户已登录 | 表单验证失败，提示"请选择服务地址" | 正确无误 |
| 4 | 选择过去日期预约 | 1. 选择服务项目<br>2. 选择过去的日期 | 用户已登录 | 日期选择器禁止选择过去日期 | 正确无误 |
| 5 | 查看服务详情 | 1. 在服务列表点击服务卡片 | 服务状态为上架 | 正确显示服务名称、价格、描述和评价列表 | 正确无误 |
| 6 | 服务已下架时预约 | 1. 访问已下架服务的详情页<br>2. 尝试点击预约 | 服务状态为下架 | 预约按钮不可用或提示"该服务暂不可用" | 正确无误 |
| 7 | 预约不存在的服务 | 1. 通过API传入不存在的服务ID创建订单 | 服务ID不存在 | 返回错误，提示"服务不存在" | 正确无误 |
| 8 | 使用他人地址下单 | 1. 通过API传入其他用户的地址ID创建订单 | 地址属于其他用户 | 返回错误，提示"地址不存在或不属于当前用户" | 正确无误 |

**测试结论**：服务预约功能模块所有测试用例均通过，功能实现符合设计预期。系统能够正确处理正常预约流程，同时对未登录、参数不完整、无效日期等异常情况均能给出合理的反馈。

### 6.3.2 阿姨抢单与执行功能测试

针对阿姨抢单与执行功能，重点测试了抢单大厅订单展示、抢单操作、订单状态流转（开始服务、完成服务）等核心流程。详细测试用例如表6.3所示。

**表6.3 阿姨抢单与执行功能测试**

| 序号 | 测试场景 | 测试步骤 | 前置条件 | 预期结果 | 实际结果 |
|------|----------|----------|----------|----------|----------|
| 1 | 查看抢单大厅 | 1. 阿姨登录工作台<br>2. 进入抢单大厅 | 阿姨已设置空闲档期 | 显示与阿姨档期匹配的待接订单列表 | 正确无误 |
| 2 | 成功抢单 | 1. 在抢单大厅选择订单<br>2. 点击"立即抢单" | 订单状态为待分配，阿姨档期匹配 | 抢单成功，订单状态变为"已分配" | 正确无误 |
| 3 | 抢单时订单已被他人接取 | 1. 同时两个阿姨尝试抢同一订单 | 两个阿姨同时操作 | 一人成功，另一人提示"订单已被接取" | 正确无误 |
| 4 | 开始服务 | 1. 进入已接订单详情<br>2. 点击"开始服务" | 订单已分配给当前阿姨 | 订单状态变为"进行中"，记录开始时间 | 正确无误 |
| 5 | 完成服务 | 1. 进入进行中的订单<br>2. 点击"完成服务" | 订单状态为进行中 | 订单状态变为"已完成"，记录完成时间 | 正确无误 |
| 6 | 档期不匹配时抢单 | 1. 阿姨未设置空闲档期<br>2. 查看抢单大厅 | 阿姨档期全为忙碌 | 抢单大厅不显示任何可接订单 | 正确无误 |
| 7 | 非本人订单操作 | 1. 尝试操作非本人接取的订单 | 订单已分配给其他阿姨 | 操作失败，提示"无权操作此订单" | 正确无误 |
| 8 | 对已分配订单重复抢单 | 1. 通过API对已分配订单发起抢单请求 | 订单状态为已分配 | 返回错误，提示"订单状态不允许接单" | 正确无误 |

**测试结论**：阿姨抢单与执行功能模块测试通过。系统正确实现了基于档期匹配的订单筛选机制，抢单流程中的并发控制有效，订单状态流转逻辑清晰，权限控制到位。

### 6.3.3 服务评价功能测试

针对服务评价功能，重点测试了评价创建、评分提交、评价内容展示等功能，同时验证了重复评价、非法订单评价等异常场景的处理。详细测试用例如表6.4所示。

**表6.4 服务评价功能测试**

| 序号 | 测试场景 | 测试步骤 | 前置条件 | 预期结果 | 实际结果 |
|------|----------|----------|----------|----------|----------|
| 1 | 成功提交评价 | 1. 进入已完成订单<br>2. 点击"评价"按钮<br>3. 选择5星评分<br>4. 填写评价内容<br>5. 点击提交 | 订单已完成且未评价 | 评价提交成功，更新阿姨评分 | 正确无误 |
| 2 | 提交低分评价 | 1. 选择2星评分<br>2. 填写评价内容<br>3. 提交 | 订单已完成 | 评价成功，阿姨综合评分相应降低 | 正确无误 |
| 3 | 不填写评分直接提交 | 1. 打开评价对话框<br>2. 不选择星级直接提交 | 订单已完成 | 提示"请选择评分" | 正确无误 |
| 4 | 重复评价同一订单 | 1. 对已评价的订单再次点击评价 | 订单已有评价 | 显示已评价内容，不允许重复提交 | 正确无误 |
| 5 | 未完成订单评价 | 1. 尝试对进行中的订单评价 | 订单状态为进行中 | 评价按钮不可用或提示"订单未完成" | 正确无误 |
| 6 | 查看服务评价列表 | 1. 进入服务详情页<br>2. 查看评价区域 | 该服务有历史评价 | 正确显示评价内容、评分和评价时间 | 正确无误 |
| 7 | 评价他人订单 | 1. 通过API尝试评价其他用户的订单 | 订单属于其他用户 | 返回错误，提示"无权评价该订单" | 正确无误 |
| 8 | 评分超出有效范围 | 1. 通过API提交评分为6或0的评价 | 订单已完成 | 返回错误，提示"评分必须在1-5之间" | 正确无误 |

**测试结论**：服务评价功能符合预期。评价流程完整，评分能够正确影响阿姨的综合评分，重复评价和非法评价等异常情况得到有效控制。

### 6.3.4 用户地址管理功能测试

针对用户地址管理功能，重点测试了地址的增删改查、默认地址设置等功能，以及各类异常输入的处理。详细测试用例如表6.5所示。

**表6.5 用户地址管理功能测试**

| 序号 | 测试场景 | 测试步骤 | 前置条件 | 预期结果 | 实际结果 |
|------|----------|----------|----------|----------|----------|
| 1 | 成功添加地址 | 1. 进入地址管理<br>2. 点击"新增地址"<br>3. 填写完整信息<br>4. 点击保存 | 用户已登录 | 地址添加成功，显示在地址列表中 | 正确无误 |
| 2 | 手机号格式错误 | 1. 新增地址时填写格式错误的手机号<br>2. 点击保存 | 用户已登录 | 提示"请输入正确的手机号" | 正确无误 |
| 3 | 必填项为空 | 1. 新增地址时不填写联系人<br>2. 点击保存 | 用户已登录 | 提示"联系人不能为空" | 正确无误 |
| 4 | 编辑现有地址 | 1. 点击地址的"编辑"按钮<br>2. 修改详细地址<br>3. 保存 | 已有保存的地址 | 地址更新成功 | 正确无误 |
| 5 | 删除地址 | 1. 点击地址的"删除"按钮<br>2. 确认删除 | 已有保存的地址 | 地址删除成功，从列表移除 | 正确无误 |
| 6 | 设置默认地址 | 1. 点击"设为默认"按钮 | 有多个保存的地址 | 设置成功，原默认地址取消默认标记 | 正确无误 |
| 7 | 预约时选择地址 | 1. 预约服务时点击选择地址<br>2. 从地址列表中选择 | 已有保存的地址 | 正确加载地址列表，选中后回填表单 | 正确无误 |
| 8 | 删除他人地址 | 1. 通过API传入其他用户的地址ID删除 | 地址属于其他用户 | 返回错误，提示"地址不存在" | 正确无误 |

**测试结论**：用户地址管理功能测试通过。CRUD操作正常，表单验证有效，默认地址切换逻辑正确，与预约模块的联动顺畅。

### 6.3.5 阿姨档期管理功能测试

针对阿姨档期管理功能，重点测试了档期设置、档期查看、档期与订单匹配等功能。详细测试用例如表6.6所示。

**表6.6 阿姨档期管理功能测试**

| 序号 | 测试场景 | 测试步骤 | 前置条件 | 预期结果 | 实际结果 |
|------|----------|----------|----------|----------|----------|
| 1 | 设置空闲档期 | 1. 进入档期管理<br>2. 点击某日期的上午时段<br>3. 设置为"空闲"<br>4. 保存 | 阿姨已登录 | 档期保存成功，界面显示绿色（空闲）标识 | 正确无误 |
| 2 | 设置忙碌档期 | 1. 点击已设置为空闲的时段<br>2. 切换为"忙碌"<br>3. 保存 | 已有空闲档期 | 档期更新成功，界面显示灰色（忙碌）标识 | 正确无误 |
| 3 | 批量设置档期 | 1. 选择多个日期时段<br>2. 批量设置为空闲<br>3. 保存 | 阿姨已登录 | 所选时段全部更新成功 | 正确无误 |
| 4 | 查看历史档期 | 1. 查看过去日期的档期记录 | 已有历史档期数据 | 正确显示历史档期状态（只读） | 正确无误 |
| 5 | 档期与抢单联动 | 1. 设置某时段为空闲<br>2. 查看抢单大厅 | 有该时段的待接订单 | 抢单大厅显示该时段的订单 | 正确无误 |
| 6 | 档期忙碌时抢单过滤 | 1. 将某时段设为忙碌<br>2. 查看抢单大厅 | 有该时段的待接订单 | 该时段订单不在抢单大厅显示 | 正确无误 |
| 7 | 设置过去日期档期 | 1. 尝试修改过去日期的档期状态 | 阿姨已登录 | 操作被禁止，过去日期不可编辑 | 正确无误 |

**测试结论**：阿姨档期管理功能符合设计要求。档期的增改查功能正常，与抢单模块的联动机制工作正确，实现了基于档期的订单智能匹配。

### 6.3.6 统计分析模块测试

针对统计分析模块，设计了不同时间范围和数据量的测试场景，验证统计数据的准确性和图表展示的正确性。详细测试用例如表6.7所示。

**表6.7 统计分析模块测试**

| 序号 | 测试场景 | 测试步骤 | 前置条件 | 预期结果 | 实际结果 |
|------|----------|----------|----------|----------|----------|
| 1 | 查看概览统计 | 1. 管理员登录后台<br>2. 进入统计分析页面 | 系统中有订单数据 | 正确显示总订单数、总用户数、总收入等概览数据 | 正确无误 |
| 2 | 查看今日订单数 | 1. 查看"今日订单"指标 | 当日有新订单生成 | 今日订单数与实际当日订单数一致 | 正确无误 |
| 3 | 查看订单趋势图（7天） | 1. 选择"近7天"时间范围<br>2. 查看订单趋势折线图 | 近7天有订单数据 | 图表正确展示每日订单数量变化 | 正确无误 |
| 4 | 查看订单趋势图（30天） | 1. 切换至"近30天"<br>2. 查看订单趋势图 | 近30天有订单数据 | 图表数据点数量正确，数值与数据库一致 | 正确无误 |
| 5 | 查看热门服务排行 | 1. 查看"热门服务"排行榜 | 有多个服务有订单 | 按订单数量降序排列，前3名标记为热门 | 正确无误 |
| 6 | 查看活跃阿姨排行 | 1. 查看"活跃阿姨"排行榜 | 有多个阿姨有订单记录 | 按评分降序排列，正确显示阿姨信息 | 正确无误 |
| 7 | 无数据时的展示 | 1. 新系统首次登录<br>2. 查看统计页面 | 系统无任何订单数据 | 概览显示0，图表提示"暂无数据" | 正确无误 |

**测试结论**：统计分析模块测试通过。各项统计数据准确，图表渲染正常，时间范围切换响应迅速，无数据时的边界情况处理得当。

### 6.3.7 后台用户管理功能测试

针对后台用户管理功能，重点测试了用户列表查询、用户状态管理、密码重置等功能，同时验证了权限控制的有效性。详细测试用例如表6.8所示。

**表6.8 后台用户管理功能测试**

| 序号 | 测试场景 | 测试步骤 | 前置条件 | 预期结果 | 实际结果 |
|------|----------|----------|----------|----------|----------|
| 1 | 查看用户列表 | 1. 管理员登录<br>2. 进入用户管理页面 | 系统中有注册用户 | 分页显示用户列表，包含必要字段 | 正确无误 |
| 2 | 按手机号搜索用户 | 1. 在搜索框输入手机号<br>2. 点击搜索 | 该手机号用户存在 | 精确匹配到对应用户 | 正确无误 |
| 3 | 按角色筛选用户 | 1. 在角色下拉框选择"阿姨"<br>2. 查看列表 | 存在阿姨角色用户 | 列表仅显示阿姨角色的用户 | 正确无误 |
| 4 | 禁用用户账号 | 1. 选择正常状态用户<br>2. 点击"禁用"按钮 | 用户当前状态正常 | 用户状态变为禁用，该用户无法登录 | 正确无误 |
| 5 | 启用用户账号 | 1. 选择已禁用用户<br>2. 点击"启用"按钮 | 用户当前状态禁用 | 用户状态恢复正常，可以正常登录 | 正确无误 |
| 6 | 重置用户密码 | 1. 点击用户的"重置密码"<br>2. 确认操作 | 用户账号存在 | 密码重置为默认值123456 | 正确无误 |
| 7 | 禁用管理员账号 | 1. 尝试禁用其他管理员 | 目标用户为管理员角色 | 操作失败，提示"不能禁用管理员账号" | 正确无误 |
| 8 | 查看用户详情 | 1. 点击用户"查看详情"按钮 | 用户账号存在 | 显示用户完整信息和历史订单记录 | 正确无误 |

**测试结论**：后台用户管理功能测试通过。列表查询和筛选功能正常，状态管理和密码重置操作有效，管理员禁用保护机制正常工作，符合安全设计要求。

## 6.4 系统性能测试

### 6.4.1 线程池性能测试

使用Apache JMeter进行并发性能测试，模拟多用户同时访问系统核心接口的场景。测试配置如下：

- **测试目标接口**：服务列表查询接口、订单创建接口、用户登录接口
- **并发用户数**：分别设置50、100、200个并发线程
- **循环次数**：每个线程执行10次请求
- **Ramp-up时间**：10秒

性能测试结果如表6.9所示。

**表6.9 线程池性能测试结果**

| 并发数 | 总请求数 | 平均响应时间(ms) | 最大响应时间(ms) | 吞吐量(req/s) | 错误率 |
|--------|----------|------------------|------------------|---------------|--------|
| 50 | 500 | 85 | 320 | 48.5 | 0% |
| 100 | 1000 | 156 | 580 | 89.2 | 0% |
| 200 | 2000 | 312 | 1250 | 152.6 | 0.1% |

测试结果表明，在200并发用户场景下，系统平均响应时间控制在350ms以内，吞吐量达到152.6请求/秒，错误率仅为0.1%，满足中小型家政服务平台的性能需求。线程池性能测试图如图6.1所示。

![线程池性能测试图](图/6.1_线程池性能测试图.png)

**图6.1 线程池性能测试图**

### 6.4.2 内存与CPU测试

在线程池测试过程中，通过JConsole工具实时监测Java虚拟机的堆内存使用情况和服务器CPU利用率。测试持续时间为10分钟，记录关键性能指标。

**测试结果**：

- **堆内存使用**：初始堆内存约256MB，高峰期堆内存使用达到680MB，在GC后回落至320MB左右，未出现内存溢出现象。
- **CPU利用率**：空闲时CPU占用约5%，并发测试期间CPU使用率峰值约45%，测试结束后迅速回落至正常水平。
- **GC情况**：Young GC频率约每2秒一次，单次耗时约15ms；Full GC未触发，说明内存管理良好。

服务节点内存与CPU利用率测试图如图6.2所示。

![服务节点内存与CPU利用率测试图](图/6.2_服务节点内存与CPU利用率测试图.png)

**图6.2 服务节点内存与CPU利用率测试图**

**测试结论**：系统在并发压力下内存使用平稳，无内存泄漏风险；CPU资源使用合理，有较大的性能余量。整体性能表现良好，能够支持平台的日常运营需求。

## 6.5 本章小结

本章对贝贝家政服务系统进行了系统性的测试工作。首先介绍了系统的部署环境和测试工具，明确了测试目标和测试方法。随后针对服务预约、阿姨抢单与执行、服务评价、用户地址管理、阿姨档期管理、统计分析和后台用户管理等七个核心功能模块，设计并执行了详尽的测试用例，覆盖了正常流程测试。

在异常输入测试方面，本章新增了用户注册与登录异常测试、后台阿姨管理异常测试、订单与预约异常测试、评价功能异常测试四个专项测试模块，共计35个异常测试用例。测试结果表明，系统对重复注册、格式错误、权限越界、状态冲突、并发操作等各类异常情况均有完善的校验和处理机制，能够给出明确的错误提示，有效防止非法数据进入系统。

在性能测试方面，使用JMeter和JConsole工具对系统的并发处理能力、响应时间和资源占用进行了评估，结果表明系统性能满足预期目标。综上所述，贝贝家政服务系统各项功能均按照需求规格正确实现，异常处理机制健全，系统稳定可靠，能够满足实际应用的需求。
