# 5 系统实现

## 5.1 系统开发环境

### 5.1.1 硬件环境

系统开发与运行所使用的硬件环境配置如下：

1. 处理器：Apple M1 Pro / Intel Core i7及以上
2. 内存：16GB DDR4及以上
3. 硬盘：512GB SSD及以上

### 5.1.2 软件环境

系统开发所依赖的软件环境及版本如下：

1. 操作系统：macOS / Windows 10/11
2. Java开发工具包：JDK 17
3. 数据库管理系统：MySQL 8.0
4. 后端开发工具：IntelliJ IDEA Ultimate
5. 前端开发工具：Visual Studio Code
6. 后端框架：Spring Boot 3.x
7. 前端框架：Vue 3 + Element Plus
8. 构建工具：Maven 3.8+, npm 9+

## 5.2 服务预约功能实现

### 5.2.1 功能描述

服务预约功能是系统的核心业务入口。用户登录系统后，可以浏览各类家政服务项目，查看服务详情，选择心仪的服务进行预约。在预约过程中，用户需要选择服务时间、填写服务地址，并确认订单金额。系统会自动校验预约信息的合法性，创建订单并通知用户。

用户进入家政服务首页后，界面清晰展示了各类服务项目。点击任意服务卡片（如"日常保洁"），系统跳转至服务详情页。在此页面，用户详细浏览服务内容、收费标准及其他用户的真实评价。点击屏幕下方的"立即预约"按钮，系统弹出预约表单。用户需点击日期控件选择服务时间，点击地址栏选择或新增服务地址，此时系统自动计算并显示预计总金额。用户确认无误后，点击"提交订单"按钮，系统即时反馈预约成功提示，并自动跳转至订单详情页，整个操作流程流畅直观，有效降低了用户的操作门槛。

### 5.2.2 系统界面

![服务预约界面](图/5.1_服务预约界面.png)

### 5.2.3 核心代码实现

后端采用RestController接收用户预约请求，通过OrderService处理业务逻辑。核心代码如下：

```java
@RestController
@RequestMapping("/api/orders")
@RequiredArgsConstructor
@Tag(name = "订单管理", description = "订单相关的接口")
public class OrderController {

    private final OrderService orderService;

    @PostMapping
    @Operation(summary = "创建订单", description = "用户创建新订单")
    public Result<Order> createOrder(@Valid @RequestBody CreateOrderRequest request) {
        try {
            Order order = orderService.createOrder(request);
            return Result.success("订单创建成功", order);
        } catch (Exception e) {
            return Result.error(e.getMessage());
        }
    }
}
```

## 5.3 阿姨抢单与执行功能实现

### 5.3.1 功能描述

阿姨端主要负责接收和处理订单。系统采用抢单模式，阿姨可以在抢单大厅查看所有待接取的订单，根据自己的档期和服务能力主动抢单。抢单成功后，阿姨需要在服务当天到达现场开始服务，服务结束后点击"完成服务"。系统会记录服务的状态变更时间，作为后续评价和结算的依据。

阿姨登录移动端工作台，首页醒目展示了"待处理"和"今日订单"概览。点击"抢单大厅"可查看所有待接取的订单，系统会根据阿姨设置的档期自动过滤，只显示时间匹配的订单。点击订单卡片可查看订单详情，仔细核对服务时间与地址后，点击底部的"立即抢单"按钮完成接单。服务当日到达现场，阿姨再次打开该订单详情，点击"开始服务"按钮，系统后台随即记录服务开始时间。服务任务圆满结束后，阿姨点击"完成服务"按钮，订单状态变更为"已完成"。整个流程设计贴合移动场景，操作简便，极大提升了阿姨的工作效率。

### 5.3.2 系统界面

![阿姨工作台界面](图/5.3_阿姨工作台界面.png)

### 5.3.3 核心代码实现

阿姨端通过WorkerOrderController进行抢单和订单状态的流转控制。核心代码如下：

```java
@RestController
@RequestMapping("/api/worker/orders")
@RequiredArgsConstructor
@PreAuthorize("hasRole('WORKER')")
@Tag(name = "阿姨订单管理", description = "阿姨端订单相关的接口")
public class WorkerOrderController {

    private final WorkerOrderService workerOrderService;

    @GetMapping("/available")
    @Operation(summary = "获取可接单的订单列表", description = "根据阿姨档期过滤，获取可以接单的订单列表")
    public Result<List<OrderListVO>> getAvailableOrders() {
        try {
            List<OrderListVO> orders = workerOrderService.getAvailableOrders();
            return Result.success("获取成功", orders);
        } catch (Exception e) {
            return Result.error(e.getMessage());
        }
    }

    @PutMapping("/{id}/take")
    @Operation(summary = "阿姨接单", description = "阿姨主动接取可接的订单")
    public Result<String> takeOrder(
            @Parameter(description = "订单ID") @PathVariable Long id) {
        try {
            workerOrderService.takeOrder(id);
            return Result.success("接单成功", "订单已接取，状态已更新为已分配");
        } catch (Exception e) {
            return Result.error(e.getMessage());
        }
    }

    @PutMapping("/{id}/complete")
    @Operation(summary = "完成订单", description = "阿姨标记订单为已完成")
    public Result<String> completeOrder(
            @Parameter(description = "订单ID") @PathVariable Long id) {
        try {
            workerOrderService.completeOrder(id);
            return Result.success("订单已完成", "订单状态已更新为已完成");
        } catch (Exception e) {
            return Result.error(e.getMessage());
        }
    }
}
```

## 5.4 服务评价功能实现

### 5.4.1 功能描述

订单完成后，用户可以对本次服务进行评价。评价内容包括评分（1-5星）和文字评论。评价数据将作为阿姨绩效考核和服务质量监控的重要指标，同时也会展示在服务详情页供其他用户参考。

在服务订单完成后，用户进入"我的订单"页面，找到状态为"已完成"的订单，点击右侧的"评价"按钮。系统弹出评价窗口，界面包含五星评分条及文本输入框。用户首先点击星级图标（1-5星）为阿姨的服务打分，随后在文本框中输入具体的服务体验与建议。确认内容无误后，点击"提交评价"按钮。系统提示评价成功，并立即将该评价同步至服务详情页及阿姨个人档案中。这一闭环设计不仅方便用户反馈，也为平台服务质量的持续优化提供了真实数据支持。

### 5.4.2 系统界面

![服务评价界面](图/5.4_服务评价界面.png)

### 5.4.3 核心代码实现

评价功能通过ReviewController实现，支持创建评价和查询评价。核心代码如下：

```java
@RestController
@RequestMapping("/api/reviews")
@RequiredArgsConstructor
public class ReviewController {

    private final ReviewService reviewService;

    @PostMapping
    @Operation(summary = "创建评价", description = "用户对已完成的订单进行评价")
    public Result<Review> createReview(@Valid @RequestBody CreateReviewRequest request) {
        try {
            Review review = reviewService.createReview(request);
            return Result.success("评价成功", review);
        } catch (Exception e) {
            return Result.error(e.getMessage());
        }
    }
}
```

## 5.5 统计分析功能实现

### 5.5.1 功能描述

管理员可以通过统计分析模块实时掌握平台运营数据的概况。功能包括订单趋势分析（日/月）、热门服务排名、活跃阿姨排名、订单状态分布等。这些数据以图表形式直观展示，辅助管理员进行经营决策。

管理员点击后台首页的"统计分析"模块，系统通过可视化仪表盘展示平台运营全貌。界面上方为核心指标概览卡片，实时显示今日订单数、成交金额及新增用户数。中部区域为动态图表，管理员可通过右上角的时间筛选器（如"近7天"、"近30天"），切换查看订单增长趋势折线图与收入统计柱状图，图表响应迅速，交互流畅。底部区域展示"热门服务"与"活跃阿姨"排行榜，支持点击查看具体明细。这种图文并茂、交互友好的数据展示方式，帮助管理员快速洞察业务趋势，做出科学决策。

### 5.5.2 系统界面

![统计分析界面](图/5.5_统计分析界面.png)

### 5.5.3 核心代码实现

统计接口聚合了多个维度的数据查询，通过StatsController统一对外暴露。核心代码如下：

```java
@RestController
@RequestMapping("/api/admin/stats")
@RequiredArgsConstructor
public class StatsController {

    private final StatsService statsService;

    @GetMapping("/overview")
    @Operation(summary = "获取概览统计")
    public Result<OverviewStatsVO> getOverviewStats() {
        OverviewStatsVO stats = statsService.getOverviewStats();
        return Result.success(stats);
    }
    
    @GetMapping("/order/trend/daily")
    @Operation(summary = "获取订单日趋势")
    public Result<List<OrderTrendVO>> getDailyOrderTrend(@RequestParam(defaultValue = "30") int days) {
        List<OrderTrendVO> trend = statsService.getDailyOrderTrend(days);
        return Result.success(trend);
    }
}
```

## 5.6 用户地址管理功能实现

### 5.6.1 功能描述

用户地址管理功能为用户提供便捷的服务地址维护能力。用户可以添加、编辑、删除自己的常用服务地址，并设置默认地址。在预约服务时，系统会自动加载用户的地址列表，用户可以快速选择已保存的地址，无需重复填写，大大提升了预约效率。

用户进入个人中心后，点击"我的地址"菜单进入地址管理页面。页面以列表形式展示用户已保存的所有地址，每条地址记录包含联系人、联系电话、省市区及详细地址信息。点击右上角的"新增地址"按钮，系统弹出地址编辑表单，用户依次填写联系人姓名、手机号码，选择省市区，输入详细地址后点击"保存"按钮。对于已有地址，用户可点击"编辑"按钮修改信息，或点击"删除"按钮移除该地址。同时，用户可通过"设为默认"按钮将某一地址标记为默认服务地址，系统在预约时将优先使用该地址。

### 5.6.2 系统界面

![用户地址管理界面](图/5.6_用户地址管理界面.png)

### 5.6.3 核心代码实现

地址管理功能通过AddressController实现，支持地址的增删改查及默认地址设置。核心代码如下：

```java
@RestController
@RequestMapping("/api/addresses")
@RequiredArgsConstructor
@Tag(name = "地址管理", description = "用户地址相关的接口")
public class AddressController {
    
    private final AddressService addressService;
    
    @GetMapping
    @Operation(summary = "获取地址列表", description = "获取当前用户的地址列表")
    public Result<List<UserAddress>> getAddresses() {
        try {
            List<UserAddress> addresses = addressService.getUserAddresses();
            return Result.success("获取成功", addresses);
        } catch (Exception e) {
            return Result.error(e.getMessage());
        }
    }
    
    @PostMapping
    @Operation(summary = "添加地址", description = "添加新的用户地址")
    public Result<String> addAddress(@Valid @RequestBody AddressRequest request) {
        try {
            addressService.addAddress(request);
            return Result.success("添加成功", "地址添加成功");
        } catch (Exception e) {
            return Result.error(e.getMessage());
        }
    }
    
    @PutMapping("/{id}/default")
    @Operation(summary = "设置默认地址", description = "设置指定地址为默认地址")
    public Result<String> setDefaultAddress(
            @Parameter(description = "地址ID") @PathVariable Long id) {
        try {
            addressService.setDefaultAddress(id);
            return Result.success("设置成功", "默认地址设置成功");
        } catch (Exception e) {
            return Result.error(e.getMessage());
        }
    }
}
```

## 5.7 阿姨档期管理功能实现

### 5.7.1 功能描述

阿姨档期管理功能允许阿姨自主管理自己的工作时间安排。阿姨可以按日期设置自己的空闲时段，系统会根据阿姨设置的档期自动匹配可接单的订单。只有当阿姨在某一时段设置为"空闲"状态时，该时段内的待接订单才会出现在阿姨的抢单大厅中，确保订单分配的合理性。

阿姨登录工作台后，点击"档期管理"进入档期设置页面。页面以日历视图展示未来一段时间的日期，每个日期下方显示上午、下午两个时间段。阿姨点击某一日期的时间段，可以切换该时段的状态（空闲/忙碌）。当状态为"空闲"时，该时段以绿色标识；当状态为"忙碌"时，以灰色标识。设置完成后，阿姨点击"保存"按钮，系统即时更新档期信息。此后，系统在阿姨查看抢单大厅时，会自动根据已设置的空闲档期，过滤并展示时间匹配的待接订单。

### 5.7.2 系统界面

![阿姨档期管理界面](图/5.7_阿姨档期管理界面.png)

### 5.7.3 核心代码实现

档期管理功能通过WorkerScheduleController实现，支持档期的查询与批量更新。核心代码如下：

```java
@RestController
@RequestMapping("/api/worker/schedule")
@RequiredArgsConstructor
@PreAuthorize("hasRole('WORKER')")
@Tag(name = "阿姨档期管理")
public class WorkerScheduleController {

    private final WorkerScheduleService workerScheduleService;

    @GetMapping
    @Operation(summary = "查询档期")
    public Result<List<WorkerScheduleDayVO>> getSchedule(
            @RequestParam(required = false) @DateTimeFormat(iso = DateTimeFormat.ISO.DATE) LocalDate startDate,
            @RequestParam(required = false) @DateTimeFormat(iso = DateTimeFormat.ISO.DATE) LocalDate endDate) {
        try {
            return Result.success(workerScheduleService.getSchedule(startDate, endDate));
        } catch (Exception e) {
            return Result.error(e.getMessage());
        }
    }

    @PutMapping
    @Operation(summary = "批量更新档期")
    public Result<String> updateSchedule(@Valid @RequestBody WorkerScheduleUpdateRequest request) {
        try {
            workerScheduleService.updateSchedule(request);
            return Result.success("档期已更新", "档期已更新");
        } catch (Exception e) {
            return Result.error(e.getMessage());
        }
    }
}
```

## 5.8 后台用户管理功能实现

### 5.8.1 功能描述

后台用户管理功能为系统管理员提供用户信息的查看与管理能力。管理员可以查看所有注册用户的列表，搜索和筛选用户，查看用户详情，启用或禁用用户账号，以及重置用户密码。该功能帮助管理员有效维护平台的用户数据安全与秩序。

管理员登录后台管理系统后，点击左侧导航栏的"用户管理"菜单进入用户列表页。页面顶部提供搜索框，支持按手机号、用户名等关键字快速检索用户。列表展示了用户的基本信息，包括头像、昵称、手机号、角色、状态及注册时间。管理员可点击"查看详情"按钮进入用户详情页，查看用户的完整资料及历史订单记录。对于违规用户，管理员可点击"禁用"按钮冻结其账号；对于忘记密码的用户，管理员可点击"重置密码"按钮将其密码重置为默认值并通知用户。

### 5.8.2 系统界面

![后台用户管理界面](图/5.8_后台用户管理界面.png)

### 5.8.3 核心代码实现

用户管理功能通过AdminUserController实现，支持用户列表查询、状态管理、密码重置等操作。核心代码如下：

```java
@RestController
@RequestMapping("/api/admin/users")
@RequiredArgsConstructor
@Tag(name = "管理员用户管理", description = "管理员用户管理相关接口")
@PreAuthorize("hasRole('ADMIN')")
public class AdminUserController {

    private final AdminUserService adminUserService;

    @GetMapping
    @Operation(summary = "分页查询用户列表", description = "支持按关键字、角色、状态筛选")
    public Result<PageResult<UserListVO>> getUserList(UserQueryRequest request) {
        try {
            PageResult<UserListVO> result = adminUserService.getUserList(request);
            return Result.success("查询成功", result);
        } catch (Exception e) {
            return Result.error(e.getMessage());
        }
    }

    @PutMapping("/{id}/status")
    @Operation(summary = "更新用户状态", description = "启用或禁用用户")
    public Result<String> updateUserStatus(
            @Parameter(description = "用户ID") @PathVariable Long id,
            @Valid @RequestBody UpdateUserStatusRequest request) {
        try {
            adminUserService.updateUserStatus(id, request);
            String action = request.getStatus() == 1 ? "启用" : "禁用";
            return Result.success("用户" + action + "成功");
        } catch (Exception e) {
            return Result.error(e.getMessage());
        }
    }

    @PutMapping("/{id}/password/reset")
    @Operation(summary = "重置用户密码", description = "重置用户密码为默认密码123456")
    public Result<String> resetUserPassword(
            @Parameter(description = "用户ID") @PathVariable Long id) {
        try {
            adminUserService.resetUserPassword(id);
            return Result.success("密码重置成功，新密码为：123456");
        } catch (Exception e) {
            return Result.error(e.getMessage());
        }
    }
}
```

## 5.9 本章小结

本章详细介绍了贝贝家政服务系统的具体实现过程，包括开发环境的搭建以及服务预约、阿姨抢单、服务评价、统计分析、用户地址管理、阿姨档期管理和后台用户管理等核心功能模块的实现。通过代码片段和界面截图，展示了系统从后端逻辑到前端展示的完整实现情况，验证了系统设计的可行性。
